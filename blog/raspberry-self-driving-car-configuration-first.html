<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Raspberry Self Driving Car Configuration First
</title>
	
	
<meta name="description" content="这篇教程整合了我的[rasp-driving-car]()上面Wiki的全部内容，这个是我本科毕业设计时做的毕业设计智能车的一个前期准备，包括树莓派上面得配置和PC上面得主要配置.
" />

	
	<link href="../css/bootstrap.min.css" rel="stylesheet">
	<link href="../css/isikdogan.css" rel="stylesheet">
	<link href="../css/font-awesome.min.css" rel="stylesheet">
	<!-- add Math Support -->
	<!-- <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script> -->
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js">
MathJax.Hub.Config({      
config: ["MMLorHTML.js"],      
extensions: ["tex2jax.js"],      
jax: ["input/TeX"],      
tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]}    
});  
</script>
<!-- <script type="text/javascript">$('.collapse').collapse()</script> -->


    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

	
  </head>

  <body>
  
  <div class="navbar navbar-inverse navbar-static-top navbar-fixed"">
  <nav>
  <div class="container">
      <ul class="nav navbar-nav">
        <li><a href="http://www.shenheng.xyz/index.html"><span class="fa fa-home fa-fw"></span> About Me</a></li>
          <li><a href="http://www.shenheng.xyz/projects.html"><span class="fa fa-cubes fa-fw"></span> Projects</a></li>
          <li><a href="http://www.shenheng.xyz/blog"><span class="fa fa-pencil fa-fw"></span> Blogs</a></li>
          <li><a href="http://github.com/rh01" target="_blank"><span class="fa fa-github fa-fw"></span> GitHub</a></li>
          
          <li><a href="https://www.youtube.com/channel/UCTOuJy4b9E89zCwffX-qC3A" target="_blank"><span class="fa fa-youtube-play fa-fw"></span> YouTube</a></li>
          <li><a href="https://www.linkedin.com/in/heng960509/" target="_blank"><span class="fa fa-linkedin fa-fw"></span> LinkedIn</a></li>
      </ul>
  </div>
  </nav>
  </div>

  <!-- <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://www.shenheng.xyz/index.html"></a>
        </div>


        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
              <li><a href="http://www.shenheng.xyz/index.html"><span class="fa fa-home fa-fw"></span> About Me</a></li>
          <li><a href="http://www.shenheng.xyz/projects.html"><span class="fa fa-cubes fa-fw"></span> Projects</a></li>
          <li><a href="http://www.shenheng.xyz/blog"><span class="fa fa-pencil fa-fw"></span> Blogs</a></li>
          <li><a href="http://github.com/rh01" target="_blank"><span class="fa fa-github fa-fw"></span> GitHub</a></li>
          
          <li><a href="https://www.youtube.com/channel/UCTOuJy4b9E89zCwffX-qC3A" target="_blank"><span class="fa fa-youtube-play fa-fw"></span> YouTube</a></li>
          <li><a href="https://www.linkedin.com/in/heng960509/" target="_blank"><span class="fa fa-linkedin fa-fw"></span> LinkedIn</a></li>
                 <li class="active"><a href=""><span class="glyphicon glyphicon-home"
                     aria-hidden="true"></span> 首页</a></li>
                <li><a href=""><span class="glyphicon glyphicon-info-sign"
                     aria-hidden="true"></span> 关于该课程设计</a></li>
                <li class="dropdown">
                    <a href="contactus.html" class="dropdown-toggle" data-toggle="dropdown"
                     role="button" aria-haspopup="true" aria-expanded="false">
                     <span class="glyphicon glyphicon-list-alt" aria-hidden="true"></span>
                     作业 <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="/crypt/classic">仿射密码</a></li>
                        <li role="separator" class="divider"></li>
                        <li class="dropdown-header">非对称加密</li>
                        <li><a href="/crypt/des">DES加密</a></li>
                        <li><a href="/crypt/rsa">RSA加密</a></li>
                        <li role="separator" class="divider"></li>
                        <li class="dropdown-header">额外的项目</li>
                        <li><a href="/crypt/lfsr">序列密码</a></li>
                        <li><a href="/crypt/dsa">DSA数字签名</a></li>
                        <li><a href="#">AES加密</a></li>

                    </ul>
                 </li>
                <li><a href=""> 
        <span class="glyphicon glyphicon-envelope" aria-hidden="true"></span>
        联系我
    </a></li>
            </ul>
            
        </div>
    </div>


</nav> -->
  
    <div class="container">
		<div class="main row">
			
			
	<div class="blog-content">

		<h1>Raspberry Self Driving Car Configuration First
</h1>
		<span class="date">May 4, 2017</span>
		
		<hr/>

		<p>这篇教程整合了我的<a href="">rasp-driving-car</a>上面Wiki的全部内容，这个是我本科毕业设计时做的毕业设计智能车的一个前期准备，包括树莓派上面得配置和PC上面得主要配置.</p>
<h1>1 系统准备</h1>
<h2>1.1 商品清单</h2>
<h3>1.1.1 树莓派3 B+</h3>
<p><div align="center"><img src="http://olrs8j04a.bkt.clouddn.com/17-12-10/41632196.jpg"> <center class="cap"><caption>图1-1 树莓派3 B+正面</caption></center></div></p>
<div align="center"><img src="http://olrs8j04a.bkt.clouddn.com/17-12-10/95921573.jpg"> <center class="cap"><caption>图1-2 树莓派3 B+侧面</caption></center></div>

<p>推荐购买渠道（链接）：<a href="https://item.taobao.com/item.htm?spm=a230r.1.14.29.bteq38&amp;id=527576110046&amp;ns=1&amp;abbucket=5#detail">淘宝</a></p>
<div align="center"><img src="http://olrs8j04a.bkt.clouddn.com/17-12-10/46514326.jpg"> <center class="cap"><caption>图1-3 购买页（裸机）</caption></center></div>

<h3>1.1.2 无线网卡（树莓派使用）</h3>
<div align="center"><img src="http://olrs8j04a.bkt.clouddn.com/17-12-10/38500109.jpg"> <center class="cap"><caption>图1-4 树莓派专用无线网卡</caption></center></div>

<div align="center"><img src="http://olrs8j04a.bkt.clouddn.com/17-12-10/22048837.jpg"> <center class="cap"><caption>图1-5 购买页（无线网卡）</caption></center></div>

<p>推荐购买渠道（链接）：<a href="https://item.taobao.com/item.htm?spm=a230r.1.14.25.xxFdXt&amp;id=22921464431&amp;ns=1&amp;abbucket=5#detail">淘宝</a></p>
<h3>1.1.3 树莓派摄像头模块（建议）</h3>
<p>树莓派摄像头模块在项目中使用到，但后期发现树莓派摄像头模块可以用普通的USB摄像头代替。（可选，建议购买，帧稳定）</p>
<div align="center"><img src="http://olrs8j04a.bkt.clouddn.com/17-12-10/58224994.jpg"> <center class="cap"><caption>图1-6 购买页（摄像头模块）</caption></center></div>

<p>推荐购买渠道（链接）：<a href="https://item.taobao.com/item.htm?spm=a1z09.2.0.0.HTGZE3&amp;id=530162749946&amp;_u=q1tnd988d6dd">淘宝</a></p>
<h3>1.1.4 内存卡（不建议网上购买）</h3>
<div align="center"><img src="http://olrs8j04a.bkt.clouddn.com/17-12-10/95832767.jpg"> <center class="cap"><caption>图1-7 购买页（TF小卡）</caption></center></div>

<p>16G够用。推荐电子商店购买，淘宝购买渠道（链接）：<a href="https://item.taobao.com/item.htm?spm=a1z10.5-c.w4002-3106558063.18.no9fXs&amp;id=524240381982">淘宝</a></p>
<h3>1.1.5 其他</h3>
<p>比如还需要准备的材料有数据线（USB数据线 -&gt; 安卓数据线），读卡器，电源（有充电宝用充电宝代替）。</p>
<h2>1.2 烧录树莓派</h2>
<h3>1.2.1 软件准备</h3>
<p>1）win32diskimager（开源软件）：<a href="https://sourceforge.net/projects/win32diskimager/">下载地址</a></p>
<div align="center"><img src="http://olrs8j04a.bkt.clouddn.com/17-12-10/90096130.jpg"> <center class="cap"><caption>图1-8 软件打开之后的样子</caption></center></div>

<p>2）树莓派系统（很多，这里选择 <strong>RASPBIAN</strong> ）：<a href="https://downloads.raspberrypi.org/raspbian_latest">下载地址</a></p>
<h3>1.2.2 步骤</h3>
<p>1）打开win32diskimager -&gt; 选中下载后的树莓派系统镜像文件 -&gt; 设备选择你的读卡器（盘符）</p>
<div align="center"><img src="http://olrs8j04a.bkt.clouddn.com/17-12-10/98990068.jpg"> <center class="cap"><caption>图1-9 选中镜像和设备</caption></center></div>

<p>2）点击写入按钮，将会对设备进行写入</p>
<div align="center"><img src="http://olrs8j04a.bkt.clouddn.com/17-12-10/9111544.jpg"> <center class="cap"><caption>图1-10 对设备进行写入操作</caption></center></div>

<p>3）写入完成后 -&gt; 对刷入的系统进行测试 -&gt; 将内存卡插入在树莓派上并试图点亮树莓派。（点亮即成功）</p>
<div align="center"><img src="http://olrs8j04a.bkt.clouddn.com/17-12-10/43763363.jpg"> <center class="cap"><caption>图1-11 设备写入成功</caption></center></div>

<p>通过上图所示，树莓派的连接方式如下图。正常的点亮方式是红灯信号灯常亮，绿色信号灯闪烁。</p>
<p><strong>NOTE</strong>：但最新的RASPBIAN系统默认刷入系统时不支持SSH服务，也就是说为了安全起见，树莓派不支持直接通过SSH登录，需要连接显示器来打开SSH服务，才能进行远程登录。</p>
<div align="center"><img src="http://olrs8j04a.bkt.clouddn.com/17-12-10/23827259.jpg"> <center class="cap"><caption>图1-12 连接方式</caption></center></div>

<h1>2 首次登陆系统进行必要的配置</h1>
<h2>2.1 必要的商品清单</h2>
<h3>2.1.1 hdmi转vga转接头（可选）</h3>
<div align="center"><img src="http://olrs8j04a.bkt.clouddn.com/17-12-10/24679462.jpg"> <center class="cap"><caption>图2-1 购买页（hdml转vga转接头）</caption></center></div>

<p>淘宝购买渠道（链接）：淘宝</p>
<h3>2.1.2 其他</h3>
<p>需要网线一根，台式电脑显示器（配有连接线）</p>
<h2>2.2 登录系统（不使用外接显示器）</h2>
<p>使用外接显示器相对比较简单，在这里省略不写。</p>
<p>从11月开始，SSH服务被禁用。所以我们通过在BOOT磁盘（也就是你的内存卡）的<code>/mnt /sdc1 /</code>文件夹中创建一个名为ssh的空文件来启用它。（即<code>/mnt/sdc1/ssh</code>）。</p>
<div align="center"><img src="http://olrs8j04a.bkt.clouddn.com/17-12-10/86547073.jpg"> <center class="cap"><caption>图2-2 在内存卡的根目录下创建一个空的文件ssh</caption></center></div>

<p>这样的话，SSH服务被启用了，节省了很多不必要的资源。通过网线连接到路由器上，组成局域网，查看路由器的管理界面找到树莓派的IP地址。如图所示。</p>
<div align="center"><img src="http://olrs8j04a.bkt.clouddn.com/17-12-10/81964379.jpg"> <center class="cap"><caption>图2-3 查看路由器管理，找到树莓派的IP地址</caption></center></div>

<p>找到IP之后，就可以在电脑端打开SSH客户端Putty，XShell，SecureCRT，以下按照XShell客户端测试。</p>
<ol>
<li>打开XShell，并输入</li>
</ol>
<pre><code class="bash">ssh pi@192.168.1.44
</code></pre>

<p>格式为<code>ssh user@ip</code>，并输入密码，默认密码：<code>raspberry</code></p>
<div align="center"><img src="http://olrs8j04a.bkt.clouddn.com/17-12-10/63300525.jpg"> <center class="cap"><caption>图2-4 登录界面</caption></center></div>

<ol>
<li>启用Picamera模块</li>
</ol>
<pre><code class="bash">sudo raspi-config
</code></pre>

<div align="center"><img src="http://olrs8j04a.bkt.clouddn.com/17-12-10/46994547.jpg"> <center class="cap"><caption></caption></center></div>

<div align="center"><img src="http://olrs8j04a.bkt.clouddn.com/17-12-10/81507310.jpg"> <center class="cap"><caption></caption></center></div>

<div align="center"><img src="http://olrs8j04a.bkt.clouddn.com/17-12-10/16449337.jpg"> <center class="cap"><caption></caption></center></div>

<div align="center"><img src="http://olrs8j04a.bkt.clouddn.com/17-12-10/28061408.jpg"> <center class="cap"><caption></caption></center></div>

<div align="center"><img src="http://olrs8j04a.bkt.clouddn.com/17-12-10/12296483.jpg"> <center class="cap"><caption></caption></center></div>

<p>完成后，测试摄像头是否成功启用。（拍摄一张照片和拍摄一段视频）</p>
<pre><code class="bash">raspistill -t 1 -o img.jpg
raspivid -o video.h264
</code></pre>

<ol>
<li>手动连接wifi</li>
</ol>
<pre><code class="bash">sudo vi /etc/wpa_supplicant/wpa_supplicant.conf
</code></pre>

<p>文件的内容如下：</p>
<pre><code class="text">country=GB
ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev
update_config=1
network={
    ssid=&quot;Netcore&quot;
    key_mgmt=WPA-PSK
    psk=&quot;327327327&quot;
}
</code></pre>

<p>然后重新启用wlan0</p>
<pre><code class="bash">sudo ifdown wlan0
sudo ifup wlan0
</code></pre>

<p>此时查看wlan0分配的IP地址：</p>
<pre><code class="bash">ifconfig
</code></pre>

<p>此时就可以拔掉网线，就可以用无线网卡连路由进行通信。</p>
<ol>
<li>更新和升级软件</li>
</ol>
<pre><code class="bash">sudo apt-get update
sudo apt-get upgrade
</code></pre>

<h2>2.3 额外的技巧</h2>
<p>一般情况下，为了好记，我经常利用DNS解析服务将我的域名解析为我的树莓派的ip地址，十分方便。</p>
<h1>3 配置AP</h1>
<h2>3.1 配置流程</h2>
<h3>3.1.1 必需的包</h3>
<ol>
<li>hostapd</li>
<li>dnsmasq</li>
</ol>
<pre><code class="bash">sudo apt-get install dnsmasq hostapd
</code></pre>

<h3>3.1.2 配置网卡</h3>
<p>将wlan1（购买的网卡）配置一个静态IP地址, 首先告诉树莓派DHCP获取IP时忽略WLAN1</p>
<pre><code class="bash">sudo nano /etc/dhcpcd.conf
</code></pre>

<p>在文件的最后添加：</p>
<pre><code class="text">denyinterfaces wlan1  
</code></pre>

<p>配置静态IP</p>
<pre><code class="bash">sudo nano /etc/network/interfaces
</code></pre>

<p>文件内容如下：</p>
<pre><code class="text">allow-hotplug wlan1  
iface wlan1 inet static  
    address 172.24.1.1
    netmask 255.255.255.0
    network 172.24.1.0
    broadcast 172.24.1.255
#    wpa-conf /etc/wpa_supplicant/wpa_supplicant.conf
</code></pre>

<p>重启DHCP服务。</p>
<pre><code class="bash">sudo apt-get install dhcpcd5 #如果没有这个服务
sudo service dhcpcd restart
</code></pre>

<p>然后重启WLAN1设备以适应配置</p>
<pre><code class="bash">sudo ifdown wlan1; sudo ifup wlan1
</code></pre>

<h3>3.1.3 配置HOSTAPD文件</h3>
<pre><code class="text">sudo nano /etc/hostapd/hostapd.conf
</code></pre>

<p>内容是：</p>
<pre><code class="text"># This is the name of the WiFi interface we configured above
interface=wlan1

# Use the nl80211 driver with the brcmfmac driver
driver=nl80211

# This is the name of the network
ssid=Pi3-AP

# Use the 2.4GHz band
hw_mode=g

# Use channel 6
channel=6

# Enable 802.11n
ieee80211n=1

# Enable WMM
wmm_enabled=1

# Enable 40MHz channels with 20ns guard interval
ht_capab=[HT40][SHORT-GI-20][DSSS_CCK-40]

# Accept all MAC addresses
macaddr_acl=0

# Use WPA authentication
auth_algs=1

# Require clients to know the network name
ignore_broadcast_ssid=0

# Use WPA2
wpa=2

# Use a pre-shared key
wpa_key_mgmt=WPA-PSK

# The network passphrase
wpa_passphrase=123456789

# Use AES, instead of TKIP
rsn_pairwise=CCMP
</code></pre>

<p>检查配置是否起作用：</p>
<pre><code class="bash">sudo /usr/sbin/hostapd /etc/hostapd/hostapd.conf
</code></pre>

<p>如果成功，则会在你的移动设备上（智能手机）上检测到Pi3-AP的路由。如果你尝试连接，则不会成功分配地址，因为还没有做完！</p>
<p>因为我们还需要告诉hostapd在启动时启动时查找配置文件。使用</p>
<pre><code class="bash">sudo nano /etc/default/hostapd
</code></pre>

<p>打开默认配置文件，找到该行</p>
<pre><code class="text">#DAEMON_CONF=&quot;&quot;
</code></pre>

<p>并且用下面这行替换掉</p>
<pre><code class="text">DAEMON_CONF=&quot;/etc/hostapd/hostapd.conf&quot;.
</code></pre>

<h3>3.1.4 配置DNSMASQ</h3>
<pre><code class="bash">sudo mv /etc/dnsmasq.conf /etc/dnsmasq.conf.orig  
sudo nano /etc/dnsmasq.conf  
</code></pre>

<p>将下面的内容粘贴上去：</p>
<pre><code class="text">interface=wlan1      # Use interface wlan0  
listen-address=172.24.1.1 # Explicitly specify the address to listen on  
bind-interfaces      # Bind to the interface to make sure we aren't sending things elsewhere  
server=8.8.8.8       # Forward DNS requests to Google DNS  
domain-needed        # Don't forward short names  
bogus-priv           # Never forward addresses in the non-routed address spaces.  
dhcp-range=172.24.1.50,172.24.1.150,12h # Assign IP addresses between 172.24.1.50 and 172.24.1.150 with a 12 hour lease time
</code></pre>

<h3>3.1.5 建立IPV4 转发</h3>
<pre><code class="bash">sudo nano /etc/sysctl.conf
</code></pre>

<p>去掉</p>
<pre><code class="bash">#net.ipv4.ip_forward=1
</code></pre>

<p>前面的#</p>
<pre><code class="bash">sudo sh -c &quot;echo 1 &gt; /proc/sys/net/ipv4/ip_forward&quot;
</code></pre>

<p>上面这条命令是立即激活转发！</p>
<p>还需要通过在wlan0接口和wlan1接口之间配置NAT来分享Pi的互联网连接到我们通过WiFi连接的设备。可以使用以下命令来执行此操作：</p>
<pre><code class="bash">sudo iptables -t nat -A POSTROUTING -o wlan0 -j MASQUERADE  
sudo iptables -A FORWARD -i wlan0 -o wlan1 -m state --state RELATED,ESTABLISHED -j ACCEPT  
sudo iptables -A FORWARD -i wlan1 -o wlan0 -j ACCEPT
</code></pre>

<p>但是，我们需要在每次重新启动Pi时应用这些规则，运行下面的命令</p>
<pre><code class="bash">sudo sh -c &quot;iptables-save &gt; /etc/iptables.ipv4.nat&quot;
</code></pre>

<p>为了避免每次重启都需要运行该命令，打开 </p>
<pre><code class="bash">sudo nano /etc/rc.local
</code></pre>

<p>在exit 0前添加一行</p>
<pre><code>iptables-restore &lt; /etc/iptables.ipv4.nat  
</code></pre>

<h3>3.1.6 我们已经完成了</h3>
<pre><code class="bash">sudo service hostapd start  
sudo service dnsmasq start  
</code></pre>

<h2>3.2 注意事项</h2>
<ol>
<li>树莓派3和树莓派2的配置过程是不一样的，上面的配置过程仅适用于树莓派3.</li>
<li>上面的配置是WLAN1做AP，WLAN0将数据流转发给WLAN1的，那么转发也可以做以太网和wlan0转发，以太网和wlan1转发。过程类似。</li>
<li>为了激活，必须重启！</li>
</ol>
<h1>4 搭建OpenCV3环境</h1>
<h2>4.1 扩大文件系统</h2>
<p>由于编译安装OpenCV需要的空间很大，所以应该做的第一件事是扩展文件系统，以包括micro-SD卡上的所有可用空间：</p>
<pre><code class="bash">sudo raspi-config
</code></pre>

<div align="center"><img src="http://olrs8j04a.bkt.clouddn.com/17-12-10/6380903.jpg"> <center class="cap"><caption></caption></center></div>

<div align="center"><img src="http://olrs8j04a.bkt.clouddn.com/17-12-10/85376892.jpg"> <center class="cap"><caption>图4-1 扩展文件系统</caption></center></div>

<h2>4.2 安装依赖</h2>
<pre><code class="bash">sudo apt-get install build-essential cmake pkg-config -y
sudo apt-get install libjpeg-dev libtiff5-dev libjasper-dev libpng12-dev -y

sudo apt-get install libavcodec-dev libavformat-dev libswscale-dev libv4l-dev -y 
sudo apt-get install libxvidcore-dev libx264-dev -y
sudo apt-get install libgtk2.0-dev -y
sudo apt-get install libatlas-base-dev gfortran -y 
sudo apt-get install python2.7-dev python3-dev -y
</code></pre>

<h2>4.3 下载OpenCV源代码</h2>
<pre><code class="bash">cd ~
wget -O opencv.zip https://github.com/Itseez/opencv/archive/3.1.0.zip
unzip opencv.zip
</code></pre>

<p>OpenCV 3.1.0 地址：https://github.com/Itseez/opencv_contrib/archive/3.1.0.zip</p>
<pre><code class="bash">wget -O opencv_contrib.zip https://github.com/Itseez/opencv_contrib/archive/3.1.0.zip
unzip opencv_contrib.zip
</code></pre>

<h2>4.4 Python2.7还是Python3.5</h2>
<ol>
<li>pip包管理器</li>
</ol>
<pre><code class="bash">wget https://bootstrap.pypa.io/get-pip.py
sudo python get-pip.py

sudo pip install virtualenv virtualenvwrapper
sudo rm -rf ~/.cache/pip

# virtualenv and virtualenvwrapper
export WORKON_HOME=$HOME/.virtualenvs
source /usr/local/bin/virtualenvwrapper.sh

echo -e &quot;\n# virtualenv and virtualenvwrapper&quot; &gt;&gt; ~/.profile
echo &quot;export WORKON_HOME=$HOME/.virtualenvs&quot; &gt;&gt; ~/.profile
echo &quot;source /usr/local/bin/virtualenvwrapper.sh&quot; &gt;&gt; ~/.profile

source ~/.profile
</code></pre>

<h3>4.4.1 安装Numpy</h3>
<pre><code class="bash">pip install numpy
</code></pre>

<p>如果正在为Python 2.7编译OpenCV 3，请确保Python 2部分包含Interpreter ，Libraries ，numpy和packages path ：</p>
<h2>4.5 编译安装OpenCV</h2>
<pre><code class="bash">cd ~/opencv-3.1.0/
mkdir build
cd build
cmake -D CMAKE_BUILD_TYPE=RELEASE \
    -D CMAKE_INSTALL_PREFIX=/usr/local \
    -D INSTALL_PYTHON_EXAMPLES=ON \
    -D OPENCV_EXTRA_MODULES_PATH=~/opencv_contrib-3.1.0/modules \
    -D BUILD_EXAMPLES=ON ..


make -j4
</code></pre>

<p>很容易出错，因为树莓派不一定CPU的资源不一定够用，使用</p>
<pre><code class="bash">make clean
make

sudo make install
sudo ldconfig
</code></pre>

<p>然后检查是否存在层<code>cv2.so</code>或者<code>cv2.cpython-34m.so</code>：</p>
<p>对于Python27说，</p>
<pre><code class="bash">ls -l /usr/local/lib/python2.7/site-packages/
</code></pre>

<p>如果存在，则说明在python2的环境下能够使用OpenCV。</p>
<p>对于Python3.4说：</p>
<pre><code class="bash">ls -l /usr/local/lib/python3.4/site-packages/
</code></pre>

<p>如果存在，则表明在Python3的环境下能够使用OpenCV</p>
<p>但是对于Python3说需要将<code>cv2.cpython-34m.so</code>重命名为<code>cv2.so</code>才能使用。</p>
<p>安装完成后，需要将编译生成的文件和解压后的文件删除。</p>
<pre><code class="bash">rm -rf opencv-3.1.0 opencv_contrib-3.1.0
</code></pre>

<h1>5 搭建机器学习与深度学习环境</h1>
<h2>5.1 搭建TensoFlow环境</h2>
<p>1）下载并安装</p>
<pre><code class="bash"># For Python 2.7
wget https://github.com/samjabrahams/tensorflow-on-raspberry-pi/releases/download/v1.1.0/tensorflow-
1.1.0-cp27-none-linux_armv7l.whl
sudo pip install tensorflow-1.1.0-cp27-none-linux_armv7l.whl
</code></pre>

<pre><code class="bash"># For Python 3.4
wget https://github.com/samjabrahams/tensorflow-on-raspberry-pi/releases/download/v1.1.0/tensorflow-
1.1.0-cp34-cp34m-linux_armv7l.whl
sudo pip3 install tensorflow-1.1.0-cp34-cp34m-linux_armv7l.whl
</code></pre>

<p>由于国内的网络原因，因此会出现403。为了避免这种事情的发生，我提前下载好了并放在了七牛云上。</p>
<ul>
<li>python2：http://olxgfquub.bkt.clouddn.com/tensorflow-1.1.0-cp27-none-linux_armv7l.whl</li>
<li>python3：http://olxgfquub.bkt.clouddn.com/tensorflow-1.1.0-cp34-cp34m-linux_armv7l.whl</li>
</ul>
<p>2）重装mock库</p>
<pre><code class="bash"># For Python 2.7
sudo pip uninstall mock
sudo pip install mock
</code></pre>

<pre><code class="bash"># For Python 3.3+
sudo pip3 uninstall mock
sudo pip3 install mock
</code></pre>

<h2>5.2 安装keras</h2>
<pre><code class="bash">sudo pip install keras
</code></pre>

<h1>参考文献</h1>
<p>[1] https://caffinc.github.io/2016/12/raspberry-pi-3-headless/[Z].: 2017.</p>
<p>[2] Frillip. https://frillip.com/using-your-raspberry-pi-3-as-a-wifi-access-point-with-hostapd/[Z]. 
2017: 2017.</p>
<p>[3] Pyimagesearch. www.pyimagesearch.com/2016/04/18/install-guide-raspberry-pi-3-raspbian-jessie-opencv- 3/[Z]. 2017: 2017.</p>
<p>[4] Samjabrahams. https://github.com/samjabrahams/tensorflow-on-raspberry-pi[Z]. 2017: 2017.</p>
<p>[5] https://raspberrypi.stackexchange.com/questions/10251/prepare-sd-card-for-wifi-on-headless-pi[Z]. 2017: 2017.</p>
<p>[6] https://github.com/hypriot/blog/issues/60[Z]. 2017: 2017.</p>
<p>[7] https://github.com/hypriot/image-builder-rpi/releases[Z]. 2017: 2017.</p>
		
		
		  <hr/>
		  raspberry, self driving car
		
		<hr/>
			<!-- 来必力City版安装代码 -->
		<!-- <div id="lv-container" data-id="city" data-uid="MTAyMC8zMDczMC83Mjgz">
		<script type="text/javascript">
		   (function(d, s) {
		       var j, e = d.getElementsByTagName(s)[0];

		       if (typeof LivereTower === 'function') { return; }

		       j = d.createElement(s);
		       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
		       j.async = true;

		       e.parentNode.insertBefore(j, e);
		   })(document, 'script');
		</script>
		<noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
		</div> -->
		<div id="disqus_thread"></div>
			<script>

			/**
			*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
			*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
			/*
			var disqus_config = function () {
			this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
			this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
			};
					*/
			(function() { // DON'T EDIT BELOW THIS LINE
			var d = document, s = d.createElement('script');
			s.src = 'https://shenhengheng.disqus.com/embed.js';
			s.setAttribute('data-timestamp', +new Date());
			(d.head || d.body).appendChild(s);
			})();
			</script>
			<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		
	</div>

	<div class="footer">
			<hr/>	
				<small>© Copyright 2016 - shenhengheng.xyz</small>
				<small class="pull-right">Powered by <a href="http://www.shenheng.xyz/blog/paperplane-a-simple-static-blog-generator.html" target="_blank">PaperPlane</a></small>
			</div>
	



		</div>
	
    </div><!-- /.container -->
	
	<link rel="icon" href="favicon.ico">
	<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,700&subset=latin,latin-ext' rel='stylesheet' type='text/css'>

	<!-- google analytics -->
	
<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-80563036-1']);
	_gaq.push(['_trackPageview']);
	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
	</script>
	
  </body>
</html>